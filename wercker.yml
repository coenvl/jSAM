# Build and test Java code
build:
  steps:
    - java/gradle:
        name: Build java code
        task: assemble
        cache_project_cache: true
    - java/gradle:
        name: Run Junit Tests
        task: test
        cache_project_cache: true
          
# Deploy anonymized code
deploy:
  box: coenvl/alpine-git
  steps:
    - add-to-known_hosts:
        hostname: github.com
        fingerprint: SHA256:nThbg6kXUpJWGl7E1IGOCspRomTxdCARLviKw6E5SY8
    - add-ssh-key:
        keyname: anonymous_github
    - script:
        name: Run anonymization script
        code: |
          ./anonymyze.sh
